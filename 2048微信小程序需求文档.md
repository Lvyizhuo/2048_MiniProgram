# 《2048微信小程序》需求文档 (PRD)

## 1. 项目概述

### 1.1 项目背景

“2048”是一款经典的益智类数字游戏，玩法简单却极具挑战性，拥有广泛的群众基础。本项目旨在微信小程序平台开发一款高质量的2048游戏，通过优化用户体验、增加社交玩法和设计合理的商业化路径，打造一款能吸引用户、产生留存并实现盈利的休闲小游戏。

### 1.2 目标用户

- **核心用户**：益智类、解谜类游戏爱好者。
- **普通用户**：寻求碎片化时间娱乐、打发时间的普通微信用户。
- **用户特征**：年龄跨度大，无性别限制，对游戏操作要求低。

### 1.3 核心价值

- **极致体验**：提供超越市面上同类产品的流畅动画与精美UI，带来舒适的视觉和操作反馈。
- **社交竞技**：引入好友排行榜，利用微信社交链增强用户粘性和攀比心理，驱动用户活跃。
- **良性变现**：通过非强制性的激励视频广告模式，在不破坏核心体验的前提下实现商业化。

------



## 2. 功能需求 (Functional Requirements)

### 2.1 核心游戏模块

#### 2.1.1 游戏棋盘

- **FR1.1**：游戏主界面应包含一个4x4的网格作为游戏棋盘背景。
- **FR1.2**：棋盘上动态渲染代表数字的“方块”。每个方块应有独立的样式。
- **FR1.3**：方块的背景色和字体颜色应根据其代表的数字（2, 4, 8...）进行区分，以提供清晰的视觉识别。

#### 2.1.2 游戏初始化

- **FR2.1**：当用户首次进入或点击“新游戏”时，游戏状态应被初始化。
- **FR2.2**：初始化内容包括：
  - 棋盘所有格子清空。
  - 当前分数（Score）重置为0。
  - 在棋盘的16个格子中，随机选择两个空位置，生成初始方块。
  - **FR2.3**：初始生成的方块数字90%概率为“2”，10%概率为“4”。

#### 2.1.3 滑动操作与合并逻辑

- **FR3.1**：用户可通过在棋盘区域进行上、下、左、右四个方向的滑动来控制所有方块的移动。
- **FR3.2**：**移动逻辑**：当用户向某个方向滑动时，所有方块应向该方向移动，直到遇到棋盘边界或其他方块。
- **FR3.3**：**合并逻辑**：在移动过程中，如果两个数字相同的方块相遇，它们应合并成一个新方块，新方块的数字为两者之和。
- **FR3.4**：一次滑动中，每个方块只能参与一次合并。例如 [4, 2, 2, 2] 向左滑动，结果应为 [4, 4, 2, 0] 而非 [8, 2, 0, 0]。
- **FR3.5**：每次成功合并（分数增加）后，应给予用户明确的反馈（如方块合并时的动画效果、音效或震动）。

#### 2.1.4 新方块生成

- **FR4.1**：在用户完成一次**有效滑动**（即至少有一个方块移动或合并）后，应在棋盘的一个随机**空位置**上生成一个新的方块。
- **FR4.2**：新生成的方块数字同样遵循90%概率为“2”，10%概率为“4”的规则。

#### 2.1.5 分数计算

- **FR5.1**：每当两个方块成功合并时，当前分数（Score）应增加，增加的数值等于合并后的新方块数值。例如，两个“8”合并成“16”，分数+16。
- **FR5.2**：系统需要记录用户的历史最高分（Best Score），并在用户打破记录时实时更新。
- **FR5.3**：历史最高分需要使用 wx.setStorageSync 进行本地持久化存储。

#### 2.1.6 游戏结束与胜利判断

- **FR6.1**：**游戏结束（Game Over）** 判断条件：当整个棋盘被方块填满，且任意方向（水平和垂直）上不存在相邻且相等的方块时，游戏结束。
- **FR6.2**：**游戏胜利**：当用户成功合成“2048”方块时，应给予胜利提示（如弹窗祝贺）。胜利后，游戏不应结束，用户可选择继续游戏以挑战更高分数。

### 2.2 UI与交互模块

#### 2.2.1 游戏主界面

- **FR7.1**：界面布局应从上到下依次为：
  1. **顶部信息区**：显示小程序名称/Logo、当前分数、历史最高分。
  2. **中部游戏区**：4x4的游戏棋盘。
  3. **底部操作区**：包含“新游戏”按钮，以及为后期功能预留的“撤销”按钮位置。
  4. **广告位**：界面最底部可为Banner广告预留固定位置。

#### 2.2.2 弹窗（Modal）

- **FR8.1**：**游戏结束弹窗**：游戏结束时，应弹出一个模态对话框，清晰地展示用户的最终得分，并提供两个按钮：
  - “重新开始”：点击后调用游戏初始化逻辑。
  - “看视频复活”：点击后触发激励式视频广告。
- **FR8.2**：**游戏胜利弹窗**：首次合成2048时弹出，包含祝贺信息和一个“继续挑战”按钮。

### 2.3 商业化与变现模块

#### 2.3.1 激励视频广告

- **FR9.1**：**复活功能**：在游戏结束弹窗中，用户可选择观看激励视频广告。观看完成后，棋盘上会随机移除3个数值最小的方块，让用户得以继续游戏。
- **FR9.2**：**撤销功能**：在游戏主界面提供一个“撤销”按钮。用户每局可免费撤销一步，后续每次撤销需观看激励视频广告。
- **FR9.3**：广告API调用必须包含完整的加载、显示、错误处理和关闭回调逻辑。

#### 2.3.2 Banner广告

- **FR10.1**：在开通流量主后，可在游戏主界面底部集成一个Banner广告位，该广告位应定时刷新。

### 2.4 社交与扩展模块

#### 2.4.1 好友排行榜

- **FR11.1**：在游戏主界面设置一个“排行榜”入口。
- **FR11.2**：用户授权后，可拉取其微信好友的游戏得分数据，并进行排名展示。
- **FR11.3**：排行榜需要使用微信开放数据域进行渲染，以保护用户隐私。

#### 2.4.2 分享功能

- **FR12.1**：用户可点击右上角胶囊菜单的“转发”按钮，将小程序分享给好友或群聊。
- **FR12.2**：分享卡片需要定制化设计，应包含小程序Logo和一句吸引人的文案（如“我得到了XXX分，你敢来挑战吗？”）。

------



## 3. 非功能需求 (Non-Functional Requirements)

### 3.1 性能要求

- **NFR1.1**：应用冷启动时间应小于2秒。
- **NFR1.2**：方块的移动和合并动画必须流畅，目标帧率60fps，无肉眼可见的卡顿。
- **NFR1.3**：滑动操作的响应时间应小于100毫秒，确保跟手感。

### 3.2 用户体验 (UX)

- **NFR2.1**：UI设计简洁美观，色彩搭配舒适，数字清晰易读。
- **NFR2.2**：提供即时反馈：
  - **动画反馈**：方块移动、生成、合并时应有平滑的动画效果。
  - **震动反馈**：方块合并时，可调用手机的短震动，增强打击感。
- **NFR2.3**：支持游戏状态保存。用户中途退出小程序后，下次进入时应能恢复到上次的游戏状态。

### 3.3 兼容性

- **NFR3.1**：应在主流的iOS和Android机型上保持UI布局一致，功能正常。

------



## 4. UI/UX 设计规范 (示例)

### 4.1 色彩方案

- **背景**：#FAF8EF
- **棋盘网格**：#BBADA0
- **方块2**：背景#EEE4DA, 文字#776E65
- **方块4**：背景#EDE0C8, 文字#776E65
- **方块8**：背景#F2B179, 文字#F9F6F2
- **方块16**：背景#F59563, 文字#F9F6F2
- ... (以此类推，数值越大颜色越深)

### 4.2 动画效果

- **方块移动**：使用ease-out缓动函数，动画时长200ms。
- **方块生成**：从缩放0.5到1的“弹出”效果，动画时长150ms。
- **方块合并**：合并瞬间有一个从1到1.2再回到1的“脉冲”效果，动画时长100ms。

------



## 5. 技术栈

- **开发框架**：微信小程序原生框架 (WXML, WXSS, JavaScript ES6+)。
- **状态管理**：Page页面自身的data及setData机制。
- **数据存储**：使用微信小程序提供的wx.setStorageSync / wx.getStorageSync API进行本地数据持久化。
- **开放能力**：使用微信开放数据域实现好友排行榜。